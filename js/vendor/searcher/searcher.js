export default class t extends HTMLElement{static get observedAttributes(){return["src","label","placeholder"]}constructor(){super();const t=this.attachShadow({mode:"open"});t.innerHTML='\n    <style>\n    :host {\n      display: inline-block;\n      position: relative;\n    }\n    div {\n      position: absolute;\n      width: 100%;\n      overflow-y: auto;\n      max-height: 500px;\n      box-shadow: 0 1px 4px #0003;\n    }\n    button {\n      display: block;\n      width: 100%;\n      box-sizing: border-box;\n      font: inherit;\n      border: none;\n      padding: 0;\n      text-align: inherit;\n    }\n    button[hidden] {\n      display: none;\n    }\n    </style>\n    <label>\n      <span part="label"></span>\n      <input type="search" autocomplete="off" part="input">\n    </label>\n\n    <div part="items" hidden></div>\n    ',this.input=t.querySelector("input"),this.itemsContainer=t.querySelector("div"),this.label=t.querySelector("label > span"),this.itemsContainer.addEventListener("selected",(t=>{this.input.value=t.target.innerText,this.itemsContainer.hidden=!0,this.dispatchEvent(new CustomEvent("selected",{detail:{label:t.target.innerHTML,value:t.target.value}}))}))}set data(t){this.innerHTML="";for(const e of t){const t=this.ownerDocument.createElement("button");t.innerHTML=e.label||e.value,t.value=e.value,t.setAttribute("part","item"),t.addEventListener("focus",(()=>this.activeItem=t)),t.addEventListener("mouseenter",(()=>this.activeItem=t));const i=`${e.search||""} ${e.label}`;t.dataset.search=n(i),t.addEventListener("click",(()=>t.dispatchEvent(new CustomEvent("selected",{bubbles:!0})))),this.itemsContainer.appendChild(t)}}connectedCallback(){const{input:t}=this;t.addEventListener("input",(()=>this.search(t.value))),t.addEventListener("keydown",(n=>{switch(n.code){case"ArrowDown":{n.preventDefault();const t=this.activeItem,i=Array.from(this.resultItems);if(t){const n=i.indexOf(t);if(i[n+1]){const t=i[n+1];this.activeItem=t,e(this.itemsContainer,t)}}else if(i.length){const t=i[0];this.activeItem=t,e(this.itemsContainer,t)}break}case"ArrowUp":{n.preventDefault();const t=this.activeItem;if(t){const n=Array.from(this.resultItems),i=n.indexOf(t);if(i>0){const t=n[i-1];this.activeItem=t,e(this.itemsContainer,t)}}break}case"Enter":const i=this.activeItem;i&&i.click();break;case"Escape":t.value="",this.search("")}}))}attributeChangedCallback(t,e,n){switch(t){case"src":if(!n){this.data=[];break}fetch(n).then((t=>t.json())).then((t=>{this.data=t}));break;case"label":this.label.innerHTML=n;break;case"placeholder":this.input.setAttribute("placeholder",n)}}get items(){return this.itemsContainer.querySelectorAll(":scope > button")}get resultItems(){return this.itemsContainer.querySelectorAll(":scope > button:not([hidden])")}get activeItem(){return this.itemsContainer.querySelector(':scope > [part~="active"]')}set activeItem(t){const e=this.activeItem;e&&e.setAttribute("part","item"),t.setAttribute("part","item active")}search(t){if(t=n(t),this.items.forEach((e=>{e.hidden=!t||-1===e.dataset.search.indexOf(t)})),!this.focusedItem){const t=this.resultItems[0];t&&(this.activeItem=t)}this.itemsContainer.hidden=!this.itemsContainer.querySelector(":scope > button:not([hidden])")}}function e(t,e){let n;const i=t.getBoundingClientRect(),s=e.getBoundingClientRect();if(i.top-s.top>0?n=e.previousElementSibling?"start":"center":i.bottom<s.bottom&&(n=e.previousElementSibling?"end":"center"),n)try{e.scrollIntoView({block:n})}catch(t){e.scrollIntoView()}}function n(t){return t.toLowerCase().replaceAll(/[^\w]+/g,"")}